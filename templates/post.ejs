<%- include('partials/head') %>

<!-- éšè—çš„å¯¼èˆªæ å ä½ -->
<header class="site-header" style="display: none;">
  <div class="header-inner">
    <a href="<%= locals.base ? locals.base + '/' : '/' %>" class="site-logo"><span class="logo-text"><%= locals.site ? locals.site.title : '' %></span></a>
  </div>
</header>

<main class="main-content post-page">
  <div class="content-wrapper">
    <!-- ç›®å½•ä¾§è¾¹æ ï¼ˆå·¦ä¾§ï¼‰ -->
    <aside class="post-toc-sidebar">
      <nav class="toc-container">
        <h3 class="toc-title">ç›®å½•</h3>
        <ul class="toc-list">
          <% if (locals.post && locals.post.toc && locals.post.toc.length > 0) { %>
            <% locals.post.toc.filter(item => item.level <= 2).forEach(item => { %>
              <li class="toc-level-<%= item.level %>">
                <a href="#<%= item.slug %>" class="toc-link"><%= item.text %></a>
              </li>
            <% }); %>
          <% } %>
        </ul>
      </nav>
    </aside>

    <!-- æ–‡ç« å†…å®¹ï¼ˆä¸­é—´ï¼‰ -->
    <div class="post-section">
      <article class="post-detail">
        <!-- æ–‡ç« å¤´éƒ¨ -->
        <header class="post-header">
          <h1 class="post-title"><%= locals.post ? locals.post.title : '' %></h1>

          <div class="post-meta">
            <time class="post-date">ðŸ“… <%= locals.post ? _.formatDate(locals.post.date) : '' %></time>

            <div class="post-categories">
              <% (locals.post ? locals.post.categories : []).forEach(cat => { %>
                <a href="<%= locals.base || '' %>/categories/<%= _.slugify(cat) %>.html" class="category-tag"><%= cat %></a>
              <% }); %>
            </div>
          </div>

          <div class="post-tags">
            <% (locals.post ? locals.post.tags : []).forEach(tag => { %>
              <a href="<%= locals.base || '' %>/tags/<%= _.slugify(tag) %>.html" class="tag"><%= tag %></a>
            <% }); %>
          </div>
        </header>

        <!-- æ–‡ç« æ­£æ–‡ -->
        <div class="post-content">
          <%- locals.post ? locals.post.content : '' %>
        </div>

        <!-- æ–‡ç« åº•éƒ¨ -->
        <footer class="post-footer-detail">
        </footer>
      </article>

      <!-- ç›¸å…³æ–‡ç«  -->
      <% if (locals.relatedPosts && locals.relatedPosts.length > 0) { %>
        <section class="related-posts">
          <h3>ç›¸å…³æ–‡ç« </h3>
          <div class="related-list">
            <% locals.relatedPosts.forEach(related => { %>
              <article class="related-card">
                <h4>
                  <a href="<%= locals.base || '' %>/posts/<%= related.slug %>.html"><%= related.title %></a>
                </h4>
                <time><%= _.formatDate(related.date) %></time>
              </article>
            <% }); %>
          </div>
        </section>
      <% } %>
    </div>
  </div>
</main>

<%- include('partials/footer') %>
